<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2575.5">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #6d6d6d; -webkit-text-stroke: #6d6d6d}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #6b0001; -webkit-text-stroke: #6b0001}
    p.p3 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #fb0007; -webkit-text-stroke: #fb0007}
    p.p4 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #0000ff; -webkit-text-stroke: #0000ff}
    p.p5 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; -webkit-text-stroke: #000000}
    p.p6 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #093c94; -webkit-text-stroke: #093c94}
    p.p7 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; -webkit-text-stroke: #000000; min-height: 16.0px}
    p.p8 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #4d5055; -webkit-text-stroke: #4d5055}
    p.p9 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #18702b; -webkit-text-stroke: #18702b}
    span.s1 {font-kerning: none; background-color: #ecf1f7}
    span.s2 {font-kerning: none; color: #fb0007; background-color: #ecf1f7; -webkit-text-stroke: 0px #fb0007}
    span.s3 {font-kerning: none; color: #2a2a2a; background-color: #ecf1f7; -webkit-text-stroke: 0px #2a2a2a}
    span.s4 {font-kerning: none; color: #000000; background-color: #ecf1f7; -webkit-text-stroke: 0px #000000}
    span.s5 {font-kerning: none; color: #0000ff; background-color: #ecf1f7; -webkit-text-stroke: 0px #0000ff}
    span.s6 {font-kerning: none; color: #6b0001; background-color: #ecf1f7; -webkit-text-stroke: 0px #6b0001}
    span.s7 {font-kerning: none; color: #18702b; background-color: #ecf1f7; -webkit-text-stroke: 0px #18702b}
    span.s8 {font-kerning: none; color: #093c94; background-color: #ecf1f7; -webkit-text-stroke: 0px #093c94}
    span.s9 {font-kerning: none; color: #137646; background-color: #ecf1f7; -webkit-text-stroke: 0px #137646}
    span.s10 {font-kerning: none}
    span.s11 {font-kerning: none; color: #6f0ec3; background-color: #ecf1f7; -webkit-text-stroke: 0px #6f0ec3}
    span.s12 {font-kerning: none; color: #4d5055; background-color: #ecf1f7; -webkit-text-stroke: 0px #4d5055}
    span.s13 {font-kerning: none; color: #0e6e6d; background-color: #ecf1f7; -webkit-text-stroke: 0px #0e6e6d}
    span.s14 {font-kerning: none; color: #a4450b; background-color: #ecf1f7; -webkit-text-stroke: 0px #a4450b}
  </style>
</head>
<body>
<p class="p1"><span class="s1">&lt;!DOCTYPE</span><span class="s2"> html</span><span class="s1">&gt;</span></p>
<p class="p2"><span class="s3">&lt;</span><span class="s1">html</span><span class="s4"> </span><span class="s2">lang</span><span class="s3">=</span><span class="s5">"th"</span><span class="s3">&gt;</span></p>
<p class="p2"><span class="s3">&lt;</span><span class="s1">head</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">meta</span><span class="s4"> </span><span class="s1">charset</span><span class="s3">=</span><span class="s5">"UTF-8"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">meta</span><span class="s4"> </span><span class="s2">name</span><span class="s3">=</span><span class="s1">"viewport"</span><span class="s4"> </span><span class="s2">content</span><span class="s3">=</span><span class="s1">"width=device-width, initial-scale=1.0"</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">title</span><span class="s3">&gt;</span><span class="s1">LMS Admin Panel</span><span class="s3">&lt;/</span><span class="s6">title</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">script</span><span class="s4"> </span><span class="s2">src</span><span class="s3">=</span><span class="s1">"https://cdn.tailwindcss.com"</span><span class="s3">&gt;&lt;/</span><span class="s6">script</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">link</span><span class="s4"> </span><span class="s2">rel</span><span class="s3">=</span><span class="s1">"stylesheet"</span><span class="s4"> </span><span class="s2">href</span><span class="s3">=</span><span class="s1">"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">link</span><span class="s4"> </span><span class="s2">href</span><span class="s3">=</span><span class="s1">"https://fonts.googleapis.com/css2?family=Anuphan:wght@300;400;500;600;700&amp;display=swap"</span><span class="s4"> </span><span class="s2">rel</span><span class="s3">=</span><span class="s1">"stylesheet"</span><span class="s3">&gt;</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s1">style</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s6">body</span><span class="s4"> { </span><span class="s1">font-family:</span><span class="s4"> </span><span class="s7">'Anuphan'</span><span class="s4">, </span><span class="s8">sans-serif</span><span class="s4">; </span><span class="s1">background-color:</span><span class="s4"> </span><span class="s8">#f1f5f9</span><span class="s4">; }</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s6">.tab-link.active</span><span class="s4"> { </span><span class="s1">border-color:</span><span class="s4"> </span><span class="s8">#ef4444</span><span class="s4">; </span><span class="s1">color:</span><span class="s4"> </span><span class="s8">#ef4444</span><span class="s4">; </span><span class="s1">font-weight:</span><span class="s4"> </span><span class="s9">600</span><span class="s4">; }</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s6">.modal-backdrop</span><span class="s1"> { </span><span class="s2">background-color:</span><span class="s1"> </span><span class="s8">rgba(</span><span class="s9">0</span><span class="s1">,</span><span class="s9">0</span><span class="s1">,</span><span class="s9">0</span><span class="s1">,</span><span class="s9">0.5</span><span class="s8">)</span><span class="s1">; }</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s6">.form-input</span><span class="s4"> { </span><span class="s2">border:</span><span class="s4"> </span><span class="s9">1px</span><span class="s4"> </span><span class="s1">solid</span><span class="s4"> </span><span class="s1">#cbd5e1</span><span class="s4">; </span><span class="s2">transition:</span><span class="s4"> </span><span class="s1">border-color</span><span class="s4"> </span><span class="s9">0.2s</span><span class="s4">, </span><span class="s1">box-shadow</span><span class="s4"> </span><span class="s9">0.2s</span><span class="s4">; }</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s6">.form-input:focus</span><span class="s4"> { </span><span class="s1">border-color:</span><span class="s4"> </span><span class="s8">#3b82f6</span><span class="s4">; </span><span class="s1">box-shadow:</span><span class="s4"> </span><span class="s9">0</span><span class="s4"> </span><span class="s9">0</span><span class="s4"> </span><span class="s9">0</span><span class="s4"> </span><span class="s9">2px</span><span class="s4"> </span><span class="s8">rgba(</span><span class="s9">59</span><span class="s4">, </span><span class="s9">130</span><span class="s4">, </span><span class="s9">246</span><span class="s4">, </span><span class="s9">0.4</span><span class="s8">)</span><span class="s4">; </span><span class="s1">outline:</span><span class="s4"> </span><span class="s8">none</span><span class="s4">; }</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s6">.btn-danger</span><span class="s4"> { </span><span class="s1">background-color:</span><span class="s4"> </span><span class="s8">#dc2626</span><span class="s4">; </span><span class="s1">color:</span><span class="s4"> </span><span class="s8">white</span><span class="s4">; }</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">.btn-danger:hover</span><span class="s4"> { </span><span class="s2">background-color:</span><span class="s4"> </span><span class="s8">#b91c1c</span><span class="s4">; }</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;/</span><span class="s1">style</span><span class="s3">&gt;</span></p>
<p class="p2"><span class="s3">&lt;/</span><span class="s1">head</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s3">&lt;</span><span class="s6">body</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-gray-800"</span><span class="s3">&gt;</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"admin-app"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"hidden"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;</span><span class="s6">header</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"bg-white shadow-md p-4 flex justify-between items-center"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">h1</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-2xl font-bold text-gray-800"</span><span class="s3">&gt;</span><span class="s4">Admin Panel</span><span class="s3">&lt;/</span><span class="s6">h1</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">span</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"admin-user-display"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"mr-4"</span><span class="s3">&gt;&lt;/</span><span class="s6">span</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">a</span><span class="s4"> </span><span class="s2">href</span><span class="s3">=</span><span class="s1">"/macros/s/YOUR_WEB_APP_ID/exec"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-blue-600 hover:underline"</span><span class="s3">&gt;</span><span class="s4">กลับหน้าหลัก</span><span class="s3">&lt;/</span><span class="s6">a</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;/</span><span class="s6">header</span><span class="s3">&gt;</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;</span><span class="s6">main</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"p-6"</span><span class="s3">&gt;</span></p>
<p class="p8"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">&lt;!-- Tabs --&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"mb-6 border-b border-gray-200"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">nav</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"-mb-px flex space-x-6"</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"admin-tabs"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;</span><span class="s6">a</span><span class="s4"> </span><span class="s2">href</span><span class="s3">=</span><span class="s1">"#"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"tab-link py-3 px-1 border-b-2 border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 active"</span><span class="s4"> </span><span class="s2">data-tab</span><span class="s3">=</span><span class="s1">"courses"</span><span class="s3">&gt;</span><span class="s4">Courses</span><span class="s3">&lt;/</span><span class="s6">a</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;</span><span class="s6">a</span><span class="s4"> </span><span class="s2">href</span><span class="s3">=</span><span class="s1">"#"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"tab-link py-3 px-1 border-b-2 border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"</span><span class="s4"> </span><span class="s2">data-tab</span><span class="s3">=</span><span class="s1">"users"</span><span class="s3">&gt;</span><span class="s4">Users</span><span class="s3">&lt;/</span><span class="s6">a</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;</span><span class="s6">a</span><span class="s4"> </span><span class="s2">href</span><span class="s3">=</span><span class="s1">"#"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"tab-link py-3 px-1 border-b-2 border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"</span><span class="s4"> </span><span class="s2">data-tab</span><span class="s3">=</span><span class="s1">"enrollments"</span><span class="s3">&gt;</span><span class="s4">Enrollments</span><span class="s3">&lt;/</span><span class="s6">a</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;/</span><span class="s6">nav</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p8"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">&lt;!-- Tab Content --&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"tab-content-container"</span><span class="s3">&gt;</span></p>
<p class="p8"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s1">&lt;!-- Content will be injected here --&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;/</span><span class="s6">main</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p8"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">&lt;!-- Modal for Add/Edit --&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"form-modal"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"hidden fixed inset-0 z-50 flex items-center justify-center modal-backdrop"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] flex flex-col"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"p-6 border-b"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">h3</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"modal-title"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-xl font-semibold"</span><span class="s3">&gt;&lt;/</span><span class="s6">h3</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">form</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"modal-form"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"p-6 space-y-4 overflow-y-auto"</span><span class="s3">&gt;</span></p>
<p class="p8"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s1">&lt;!-- Form fields will be injected here --&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;/</span><span class="s6">form</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"p-4 bg-gray-50 flex justify-end space-x-3 border-t"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s4"> </span><span class="s2">type</span><span class="s3">=</span><span class="s1">"button"</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"modal-close-btn"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"bg-gray-200 hover:bg-gray-300 py-2 px-4 rounded-md"</span><span class="s3">&gt;</span><span class="s4">ยกเลิก</span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s4"> </span><span class="s2">type</span><span class="s3">=</span><span class="s1">"submit"</span><span class="s4"> </span><span class="s2">form</span><span class="s3">=</span><span class="s1">"modal-form"</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"modal-save-btn"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-md"</span><span class="s3">&gt;</span><span class="s4">บันทึก</span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">    </span></span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"loading-overlay"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"fixed inset-0 bg-white bg-opacity-75 flex items-center justify-center z-[100]"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;</span><span class="s6">i</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"fas fa-spinner fa-spin text-4xl text-blue-600"</span><span class="s3">&gt;&lt;/</span><span class="s6">i</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s1">script</span><span class="s3">&gt;</span></p>
<p class="p9"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s11">const</span><span class="s4"> webAppUrl = </span><span class="s1">'https://script.google.com/macros/s/AKfycbyEp94nsAG2ZGeoeys4trXnRfUGDev7vm9wEnpF1Qtb-WWub7gvqblAG8WHb6fJd_ouVw/exec'</span><span class="s4">; </span><span class="s12">// !!! REPLACE WITH YOUR DEPLOYED WEB APP URL !!!</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s11">let</span><span class="s1"> adminData = {};</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s11">let</span><span class="s1"> currentTab = </span><span class="s7">'courses'</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s11">let</span><span class="s1"> currentRecord = </span><span class="s11">null</span><span class="s1">;</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p8"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// --- API HANDLER ---</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s11">async</span><span class="s1"> </span><span class="s11">function</span><span class="s1"> apiRequest(action, data = {}) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s1"> user = </span><span class="s13">JSON</span><span class="s1">.parse(sessionStorage.getItem(</span><span class="s7">'user'</span><span class="s1">));</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">if</span><span class="s1"> (user &amp;&amp; user.email) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>data.userEmail = user.email;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s1"> response = </span><span class="s11">await</span><span class="s1"> fetch(webAppUrl, {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>method: </span><span class="s7">'POST'</span><span class="s1">,</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>headers: { </span><span class="s7">'Content-Type'</span><span class="s1">: </span><span class="s7">'application/json'</span><span class="s1"> },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>body: </span><span class="s13">JSON</span><span class="s1">.stringify({ action, data }),</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>redirect: </span><span class="s7">'follow'</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>});</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">if</span><span class="s1"> (!response.ok) </span><span class="s11">throw</span><span class="s1"> </span><span class="s11">new</span><span class="s1"> </span><span class="s13">Error</span><span class="s1">(</span><span class="s7">'Server connection error'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s1"> result = </span><span class="s11">await</span><span class="s1"> response.json();</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">if</span><span class="s1"> (result.status === </span><span class="s7">'success'</span><span class="s1">) </span><span class="s11">return</span><span class="s1"> result.data;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">throw</span><span class="s1"> </span><span class="s11">new</span><span class="s1"> </span><span class="s13">Error</span><span class="s1">(result.message || </span><span class="s7">'Unknown error'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p8"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// --- TEMPLATES &amp; RENDERERS ---</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s11">const</span><span class="s1"> tableTemplates = {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>courses: {</span></p>
<p class="p9"><span class="s4"><span class="Apple-converted-space">                </span>headers: [</span><span class="s1">'courseId'</span><span class="s4">, </span><span class="s1">'title'</span><span class="s4">, </span><span class="s1">'category'</span><span class="s4">, </span><span class="s1">'instructor'</span><span class="s4">],</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>idColumn: </span><span class="s7">'courseId'</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>},</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>users: {</span></p>
<p class="p9"><span class="s4"><span class="Apple-converted-space">                </span>headers: [</span><span class="s1">'userId'</span><span class="s4">, </span><span class="s1">'username'</span><span class="s4">, </span><span class="s1">'name'</span><span class="s4">, </span><span class="s1">'email'</span><span class="s4">, </span><span class="s1">'isAdmin'</span><span class="s4">],</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>idColumn: </span><span class="s7">'userId'</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>},</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>enrollments: {</span></p>
<p class="p9"><span class="s4"><span class="Apple-converted-space">                </span>headers: [</span><span class="s1">'enrollmentId'</span><span class="s4">, </span><span class="s1">'userEmail'</span><span class="s4">, </span><span class="s1">'courseId'</span><span class="s4">, </span><span class="s1">'startDate'</span><span class="s4">, </span><span class="s1">'durationDays'</span><span class="s4">, </span><span class="s1">'progress'</span><span class="s4">],</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>idColumn: </span><span class="s7">'enrollmentId'</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>};</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s11">const</span><span class="s1"> formTemplates = {</span></p>
<p class="p9"><span class="s4"><span class="Apple-converted-space">            </span>courses: [</span><span class="s1">'courseId'</span><span class="s4">, </span><span class="s1">'title'</span><span class="s4">, </span><span class="s1">'description'</span><span class="s4">, </span><span class="s1">'category'</span><span class="s4">, </span><span class="s1">'instructor'</span><span class="s4">, </span><span class="s1">'coverImg'</span><span class="s4">, </span><span class="s1">'contentJsonString'</span><span class="s4">],</span></p>
<p class="p9"><span class="s4"><span class="Apple-converted-space">            </span>users: [</span><span class="s1">'userId'</span><span class="s4">, </span><span class="s1">'username'</span><span class="s4">, </span><span class="s1">'name'</span><span class="s4">, </span><span class="s1">'email'</span><span class="s4">, </span><span class="s1">'password'</span><span class="s4">, </span><span class="s1">'isAdmin'</span><span class="s4">],</span></p>
<p class="p9"><span class="s4"><span class="Apple-converted-space">            </span>enrollments: [</span><span class="s1">'enrollmentId'</span><span class="s4">, </span><span class="s1">'userEmail'</span><span class="s4">, </span><span class="s1">'courseId'</span><span class="s4">, </span><span class="s1">'startDate'</span><span class="s4">, </span><span class="s1">'durationDays'</span><span class="s4">, </span><span class="s1">'progress'</span><span class="s4">]</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>};</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s11">function</span><span class="s1"> renderTable(tabName) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s1"> container = document.getElementById(</span><span class="s7">'tab-content-container'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s1"> template = tableTemplates[tabName];</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s1"> data = adminData[tabName] || [];</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s1"> tableHeaders = template.headers.map(h =&gt; </span><span class="s7">`&lt;th class="p-3 text-left font-semibold"&gt;</span><span class="s1">${h}</span><span class="s7">&lt;/th&gt;`</span><span class="s1">).join(</span><span class="s7">''</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s1"> tableRows = data.map(row =&gt; {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s11">const</span><span class="s1"> cells = template.headers.map(h =&gt; </span><span class="s7">`&lt;td class="p-3 border-t"&gt;</span><span class="s1">${row[h] === </span><span class="s11">undefined</span><span class="s1"> ? </span><span class="s7">''</span><span class="s1"> : row[h]}</span><span class="s7">&lt;/td&gt;`</span><span class="s1">).join(</span><span class="s7">''</span><span class="s1">);</span></p>
<p class="p9"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s11">return</span><span class="s4"> </span><span class="s1">`&lt;tr class="hover:bg-gray-50"&gt;</span></p>
<p class="p9"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s4">${cells}</span></p>
<p class="p9"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;td class="p-3 border-t text-right"&gt;</span></p>
<p class="p9"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;button class="edit-btn text-blue-600 mr-2" data-id="</span><span class="s4">${row[template.idColumn]}</span><span class="s1">"&gt;&lt;i class="fas fa-edit"&gt;&lt;/i&gt;&lt;/button&gt;</span></p>
<p class="p9"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;button class="delete-btn text-red-600" data-id="</span><span class="s4">${row[template.idColumn]}</span><span class="s1">"&gt;&lt;i class="fas fa-trash"&gt;&lt;/i&gt;&lt;/button&gt;</span></p>
<p class="p9"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/td&gt;</span></p>
<p class="p9"><span class="s1"><span class="Apple-converted-space">                </span>&lt;/tr&gt;`</span><span class="s4">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>}).join(</span><span class="s7">''</span><span class="s1">);</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>container.innerHTML = </span><span class="s7">`</span></p>
<p class="p9"><span class="s1"><span class="Apple-converted-space">                </span>&lt;div class="bg-white p-4 rounded-lg shadow"&gt;</span></p>
<p class="p9"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;div class="flex justify-between items-center mb-4"&gt;</span></p>
<p class="p9"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;h2 class="text-xl font-bold capitalize"&gt;</span><span class="s4">${tabName}</span><span class="s1">&lt;/h2&gt;</span></p>
<p class="p9"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;button id="add-new-btn" class="bg-green-600 hover:bg-green-700 text-white py-2 px-4 rounded-md"&gt;</span></p>
<p class="p9"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;i class="fas fa-plus mr-2"&gt;&lt;/i&gt;เพิ่มใหม่</span></p>
<p class="p9"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/button&gt;</span></p>
<p class="p9"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</span></p>
<p class="p9"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;div class="overflow-x-auto"&gt;</span></p>
<p class="p9"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;table class="w-full text-sm"&gt;</span></p>
<p class="p9"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;thead&gt;&lt;tr class="bg-gray-100"&gt;</span><span class="s4">${tableHeaders}</span><span class="s1">&lt;th class="p-3"&gt;Actions&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;</span></p>
<p class="p9"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;tbody&gt;</span><span class="s4">${tableRows}</span><span class="s1">&lt;/tbody&gt;</span></p>
<p class="p9"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/table&gt;</span></p>
<p class="p9"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</span></p>
<p class="p9"><span class="s1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</span></p>
<p class="p9"><span class="s1"><span class="Apple-converted-space">            </span>`</span><span class="s4">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s11">function</span><span class="s1"> renderForm(tabName, record = {}) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s1"> form = document.getElementById(</span><span class="s7">'modal-form'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s1"> fields = formTemplates[tabName];</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>form.innerHTML = fields.map(field =&gt; {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s11">const</span><span class="s1"> value = record[field] === </span><span class="s11">undefined</span><span class="s1"> ? </span><span class="s7">''</span><span class="s1"> : record[field];</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s11">const</span><span class="s1"> isTextarea = field === </span><span class="s7">'description'</span><span class="s1"> || field === </span><span class="s7">'contentJsonString'</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s11">const</span><span class="s1"> inputType = field === </span><span class="s7">'password'</span><span class="s1"> ? </span><span class="s7">'password'</span><span class="s1"> : </span><span class="s7">'text'</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s11">const</span><span class="s1"> placeholder = field === </span><span class="s7">'password'</span><span class="s1"> &amp;&amp; </span><span class="s13">Object</span><span class="s1">.keys(record).length &gt; </span><span class="s14">0</span><span class="s1"> ? </span><span class="s7">'เว้นว่างไว้หากไม่ต้องการเปลี่ยน'</span><span class="s1"> : </span><span class="s7">''</span><span class="s1">;</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s11">if</span><span class="s1"> (isTextarea) {</span></p>
<p class="p9"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s11">return</span><span class="s4"> </span><span class="s1">`&lt;div&gt;&lt;label class="block font-medium mb-1"&gt;</span><span class="s4">${field}</span><span class="s1">&lt;/label&gt;&lt;textarea name="</span><span class="s4">${field}</span><span class="s1">" class="form-input w-full p-2 rounded-md h-32"&gt;</span><span class="s4">${value}</span><span class="s1">&lt;/textarea&gt;&lt;/div&gt;`</span><span class="s4">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p9"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s11">return</span><span class="s4"> </span><span class="s1">`&lt;div&gt;&lt;label class="block font-medium mb-1"&gt;</span><span class="s4">${field}</span><span class="s1">&lt;/label&gt;&lt;input type="</span><span class="s4">${inputType}</span><span class="s1">" name="</span><span class="s4">${field}</span><span class="s1">" value="</span><span class="s4">${value}</span><span class="s1">" placeholder="</span><span class="s4">${placeholder}</span><span class="s1">" class="form-input w-full p-2 rounded-md"&gt;&lt;/div&gt;`</span><span class="s4">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>}).join(</span><span class="s7">''</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p8"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// --- EVENT HANDLERS ---</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>document.getElementById(</span><span class="s7">'admin-tabs'</span><span class="s1">).addEventListener(</span><span class="s7">'click'</span><span class="s1">, e =&gt; {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>e.preventDefault();</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">if</span><span class="s1"> (e.target.matches(</span><span class="s7">'.tab-link'</span><span class="s1">)) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>document.querySelectorAll(</span><span class="s7">'.tab-link'</span><span class="s1">).forEach(t =&gt; t.classList.remove(</span><span class="s7">'active'</span><span class="s1">));</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>e.target.classList.add(</span><span class="s7">'active'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>currentTab = e.target.dataset.tab;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>renderTable(currentTab);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>});</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>document.getElementById(</span><span class="s7">'tab-content-container'</span><span class="s1">).addEventListener(</span><span class="s7">'click'</span><span class="s1">, e =&gt; {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s1"> addBtn = e.target.closest(</span><span class="s7">'#add-new-btn'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s1"> editBtn = e.target.closest(</span><span class="s7">'.edit-btn'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s1"> deleteBtn = e.target.closest(</span><span class="s7">'.delete-btn'</span><span class="s1">);</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">if</span><span class="s1"> (addBtn) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>currentRecord = </span><span class="s11">null</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>document.getElementById(</span><span class="s7">'modal-title'</span><span class="s1">).textContent = </span><span class="s7">`เพิ่มข้อมูล </span><span class="s1">${currentTab}</span><span class="s7">`</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>renderForm(currentTab);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>document.getElementById(</span><span class="s7">'form-modal'</span><span class="s1">).classList.remove(</span><span class="s7">'hidden'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">if</span><span class="s1"> (editBtn) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s11">const</span><span class="s1"> id = editBtn.dataset.id;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s11">const</span><span class="s1"> idColumn = tableTemplates[currentTab].idColumn;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>currentRecord = adminData[currentTab].find(r =&gt; r[idColumn].toString() === id);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>document.getElementById(</span><span class="s7">'modal-title'</span><span class="s1">).textContent = </span><span class="s7">`แก้ไขข้อมูล </span><span class="s1">${currentTab}</span><span class="s7">`</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>renderForm(currentTab, currentRecord);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>document.getElementById(</span><span class="s7">'form-modal'</span><span class="s1">).classList.remove(</span><span class="s7">'hidden'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">if</span><span class="s1"> (deleteBtn) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s11">const</span><span class="s1"> id = deleteBtn.dataset.id;</span></p>
<p class="p9"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s11">if</span><span class="s4"> (confirm(</span><span class="s1">`คุณแน่ใจหรือไม่ว่าต้องการลบข้อมูลนี้?`</span><span class="s4">)) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>handleDelete(id);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>});</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>document.getElementById(</span><span class="s7">'modal-form'</span><span class="s1">).addEventListener(</span><span class="s7">'submit'</span><span class="s1">, e =&gt; {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>e.preventDefault();</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>handleSave();</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>});</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>document.getElementById(</span><span class="s7">'modal-close-btn'</span><span class="s1">).addEventListener(</span><span class="s7">'click'</span><span class="s1">, () =&gt; {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>document.getElementById(</span><span class="s7">'form-modal'</span><span class="s1">).classList.add(</span><span class="s7">'hidden'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>});</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p8"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// --- DATA LOGIC ---</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s11">async</span><span class="s1"> </span><span class="s11">function</span><span class="s1"> handleSave() {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s1"> form = document.getElementById(</span><span class="s7">'modal-form'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s1"> formData = </span><span class="s11">new</span><span class="s1"> </span><span class="s13">FormData</span><span class="s1">(form);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s1"> record = </span><span class="s13">Object</span><span class="s1">.fromEntries(formData.entries());</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p8"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Handle specific data types</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">if</span><span class="s1"> (record.isAdmin) record.isAdmin = record.isAdmin.toLowerCase() === </span><span class="s7">'true'</span><span class="s1"> || record.isAdmin === </span><span class="s7">'on'</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">if</span><span class="s1"> (record.progress) record.progress = </span><span class="s13">Number</span><span class="s1">(record.progress);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">if</span><span class="s1"> (record.durationDays) record.durationDays = </span><span class="s13">Number</span><span class="s1">(record.durationDays);</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">try</span><span class="s1"> {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s11">if</span><span class="s1"> (currentRecord) { </span><span class="s12">// Update</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s11">const</span><span class="s1"> idColumn = tableTemplates[currentTab].idColumn;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s11">const</span><span class="s1"> recordId = currentRecord[idColumn];</span></p>
<p class="p8"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s1">// Don't send empty password on update</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s11">if</span><span class="s1"> (record.password === </span><span class="s7">''</span><span class="s1">) </span><span class="s11">delete</span><span class="s1"> record.password;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s11">await</span><span class="s1"> apiRequest(</span><span class="s7">'updateRecord'</span><span class="s1">, { sheetName: currentTab, recordId, record, idColumn });</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>} </span><span class="s11">else</span><span class="s1"> { </span><span class="s12">// Add</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s11">await</span><span class="s1"> apiRequest(</span><span class="s7">'addRecord'</span><span class="s1">, { sheetName: currentTab, record: record });</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>document.getElementById(</span><span class="s7">'form-modal'</span><span class="s1">).classList.add(</span><span class="s7">'hidden'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s11">await</span><span class="s1"> loadAdminData(); </span><span class="s12">// Reload data</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>} </span><span class="s11">catch</span><span class="s1"> (error) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>alert(</span><span class="s7">`เกิดข้อผิดพลาด: </span><span class="s1">${error.message}</span><span class="s7">`</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s11">async</span><span class="s1"> </span><span class="s11">function</span><span class="s1"> handleDelete(id) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">try</span><span class="s1"> {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s11">const</span><span class="s1"> idColumn = tableTemplates[currentTab].idColumn;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s11">await</span><span class="s1"> apiRequest(</span><span class="s7">'deleteRecord'</span><span class="s1">, { sheetName: currentTab, recordId: id, idColumn });</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s11">await</span><span class="s1"> loadAdminData();</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>} </span><span class="s11">catch</span><span class="s1"> (error) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>alert(</span><span class="s7">`เกิดข้อผิดพลาด: </span><span class="s1">${error.message}</span><span class="s7">`</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s11">async</span><span class="s1"> </span><span class="s11">function</span><span class="s1"> loadAdminData() {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>document.getElementById(</span><span class="s7">'loading-overlay'</span><span class="s1">).classList.remove(</span><span class="s7">'hidden'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">try</span><span class="s1"> {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>adminData = </span><span class="s11">await</span><span class="s1"> apiRequest(</span><span class="s7">'getAdminData'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>renderTable(currentTab);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>} </span><span class="s11">catch</span><span class="s1"> (error) {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>document.getElementById(</span><span class="s7">'tab-content-container'</span><span class="s1">).innerHTML = </span><span class="s7">`&lt;p class="text-red-500 text-center"&gt;</span><span class="s1">${error.message}</span><span class="s7">&lt;/p&gt;`</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>} </span><span class="s11">finally</span><span class="s1"> {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>document.getElementById(</span><span class="s7">'loading-overlay'</span><span class="s1">).classList.add(</span><span class="s7">'hidden'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p8"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// --- INITIALIZATION ---</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>(</span><span class="s11">function</span><span class="s1"> init() {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s1"> user = </span><span class="s13">JSON</span><span class="s1">.parse(sessionStorage.getItem(</span><span class="s7">'user'</span><span class="s1">));</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s1"> webAppId = webAppUrl.split(</span><span class="s7">'/'</span><span class="s1">)[</span><span class="s14">5</span><span class="s1">];</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p9"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s4"> homeLink = document.querySelector(</span><span class="s1">'a[href*="AKfycbyEp94nsAG2ZGeoeys4trXnRfUGDev7vm9wEnpF1Qtb-WWub7gvqblAG8WHb6fJd_ouVw"]'</span><span class="s4">);</span></p>
<p class="p9"><span class="s4"><span class="Apple-converted-space">            </span>homeLink.href = homeLink.href.replace(</span><span class="s1">'AKfycbyEp94nsAG2ZGeoeys4trXnRfUGDev7vm9wEnpF1Qtb-WWub7gvqblAG8WHb6fJd_ouVw'</span><span class="s4">, webAppId);</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">if</span><span class="s1"> (!user || !user.isAdmin) {</span></p>
<p class="p9"><span class="s4"><span class="Apple-converted-space">                </span>document.body.innerHTML = </span><span class="s1">`&lt;div class="text-center p-10"&gt;&lt;h1 class="text-2xl text-red-600"&gt;Access Denied&lt;/h1&gt;&lt;p&gt;คุณต้องเป็นผู้ดูแลระบบเพื่อเข้าถึงหน้านี้&lt;/p&gt;&lt;a href="/macros/s/</span><span class="s4">${webAppId}</span><span class="s1">/exec" class="text-blue-600 hover:underline mt-4 inline-block"&gt;กลับไปหน้าล็อกอิน&lt;/a&gt;&lt;/div&gt;`</span><span class="s4">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s11">return</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p7"><span class="s10"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>document.getElementById(</span><span class="s7">'admin-user-display'</span><span class="s1">).textContent = </span><span class="s7">`ล็อกอินในฐานะ: </span><span class="s1">${user.name}</span><span class="s7">`</span><span class="s1">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>document.getElementById(</span><span class="s7">'admin-app'</span><span class="s1">).classList.remove(</span><span class="s7">'hidden'</span><span class="s1">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span>loadAdminData();</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span>})();</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;/</span><span class="s1">script</span><span class="s3">&gt;</span></p>
<p class="p2"><span class="s3">&lt;/</span><span class="s1">body</span><span class="s3">&gt;</span></p>
<p class="p2"><span class="s3">&lt;/</span><span class="s1">html</span><span class="s3">&gt;</span></p>
<p class="p7"><span class="s10"></span><br></p>
</body>
</html>
